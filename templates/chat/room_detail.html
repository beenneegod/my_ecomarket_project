{% extends "base.html" %}
{% load static i18n %}

{% block title %}Pokój — EcoMarket{% endblock %}

{% block content %}
<div id="chat-root"
		 class="container mt-4"
		 data-room-id="{{ room.id }}"
		 data-username="{{ request.user.username|escapejs }}"
		 data-messages-api="{% url 'chat:messages_api' room.id %}">
	<h2>{{ room.name }}</h2>
	{% if room.topic %}<div class="text-muted mb-3">Temat: {{ room.topic }}</div>{% endif %}
	<div id="messages" class="border rounded p-3 mb-3 chat-messages"></div>
	<form id="sendForm" method="post" action="{% url 'chat:send_message' room.id %}" enctype="multipart/form-data">
		{% csrf_token %}
		{{ form.text }}
		<div class="mt-2 d-flex align-items-center gap-2">
			<input type="file" name="attachments" id="attachments" multiple accept="image/*,application/pdf" class="form-control d-none" aria-label="Załączniki" />
			<label for="attachments" class="btn btn-outline-secondary">Dodaj plik(i)</label>
			<span id="attachmentsInfo" class="text-muted small"></span>
			<button class="btn btn-primary ms-auto">Wyślij</button>
		</div>
	</form>
	<hr/>
	<form id="inviteForm" class="d-flex gap-2" action="{% url 'chat:send_invite' room.id %}" method="post">
		{% csrf_token %}
		<label for="invite-username" class="visually-hidden">{% trans "Nazwa użytkownika do zaproszenia" %}</label>
		<input id="invite-username" name="username" class="form-control chat-invite-input" placeholder="@nazwa_użytkownika" />
		<button class="btn btn-outline-secondary">Zaproś</button>
	</form>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/chat.css' %}">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/chat_room.js' %}"></script>
{% endblock %}
